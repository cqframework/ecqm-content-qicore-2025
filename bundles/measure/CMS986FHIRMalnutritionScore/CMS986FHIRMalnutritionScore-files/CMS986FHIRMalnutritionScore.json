{
  "resourceType": "Library",
  "id": "CMS986FHIRMalnutritionScore",
  "meta": {
    "profile": [ "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-computablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-executablelibrary", "http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-json-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-xml-library" ]
  },
  "language": "en",
  "text": {
    "status": "extensions",
    "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"col-12\">\n  <table class=\"narrative-table\">\n    <tbody>\n<tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Knowledge Artifact Metadata</th>\n\n</tr>\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Name (machine-readable)</th>\n\n<td class=\"content-container\">CMS986FHIRMalnutritionScore</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Title (human-readable)</th>\n\n<td class=\"content-container\">CMS986FHIRMalnutritionScore</td>\n</tr>\n\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Status</th>\n\n<td class=\"content-container\">active</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Experimental</th>\n\n<td class=\"content-container\">false</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Description</th>\n\n<td class=\"content-container\">CMS986FHIRMalnutritionScore</td>\n</tr>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Library Steward</th>\n\n<td class=\"content-container\">Academy of Nutrition and Dietetics</td>\n</tr>\n\n\n\n\n\n\n\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library FHIRHelpers\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/FHIRHelpers|4.4.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/FHIRHelpers|4.4.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library QICoreCommon\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/QICoreCommon|4.0.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/QICoreCommon|4.0.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library CQMCommon\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/CQMCommon|4.1.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/CQMCommon|4.1.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Library SDE\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: https://madie.cms.gov/Library/SupplementalDataElements|5.1.000\n    <br/>\n    <em>Canonical URL</em>: <tt>https://madie.cms.gov/Library/SupplementalDataElements|5.1.000</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Encounter Inpatient\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Hospice Care Referral or Admission\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Hospice Status\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.101\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.101</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Malnutrition Risk Screening\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.92\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.92</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Malnutrition Screening Finding of Not At Risk Result\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.34\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.34</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Malnutrition Screening Finding of At Risk Result\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.89\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.89</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Dietitian Referral\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.91\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.91</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Nutrition Assessment\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.21\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.21</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Nutrition Assessment Status Finding of Well Nourished or Not Malnourished or Mildly Malnourished\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.96\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.96</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Nutrition Assessment Status Finding of Moderately Malnourished\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.47\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.47</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Nutrition Assessment Status Finding of Severely Malnourished\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.43\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.43</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Malnutrition Diagnosis\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.55\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.55</tt>\n    \n  </td>\n</tr>\n\n<tr>\n  \n  \n  \n  \n  \n<th scope=\"row\" class=\"row-header\">Dependency</th>\n\n  \n  <td class=\"content-container\">\n    \n    <em>Description</em>: Value set Nutrition Care Plan\n    \n    <br/>\n    \n    \n    \n    \n    \n    \n    <em>Resource</em>: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.93\n    <br/>\n    <em>Canonical URL</em>: <tt>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.93</tt>\n    \n  </td>\n</tr>\n\n\n\n\n\n\n\n\n\n\n<tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Library Metadata</th>\n\n</tr>\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Identifier</th>\n\n<td class=\"content-container\">org.hl7.fhir.r5.model.Identifier@4f2da3b3</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Version Number</th>\n\n<td class=\"content-container\">0.3.003</td>\n</tr>\n\n\n<tr>\n\n<th scope=\"row\" class=\"row-header\">Library Type</th>\n\n<td class=\"content-container\">[http://terminology.hl7.org/CodeSystem/library-type#logic-library]</td>\n</tr>\n\n\n\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: ServiceRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-servicerequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value, intent, intent.value, doNotPerform, doNotPerform.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.101\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: ServiceRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-servicerequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value, intent, intent.value, doNotPerform, doNotPerform.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.91\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Procedure\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.101\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Procedure\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.91\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.55\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: code</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.55\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: type, period, status, status.value\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: type</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n\n\n  <tr>\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Library Content</th>\n\n</tr>\n  \n    \n    <tr>\n      <th scope=\"row\" class=\"row-header\">CQL Content</th>\n      <td>\n        <pre style=\"border: none;\" class=\"content-container highlight language-cql\"><code class=\"language-cql\">library CMS986FHIRMalnutritionScore version '0.3.003'\r\n\r\nusing QICore version '6.0.0'\r\n\r\ninclude FHIRHelpers version '4.4.000' called FHIRHelpers\r\ninclude SupplementalDataElements version '5.1.000' called SDE\r\ninclude QICoreCommon version '4.0.000' called QICoreCommon\r\ninclude CQMCommon version '4.1.000' called CQMCommon\r\n\r\ncodesystem &quot;LOINC&quot;: 'http://loinc.org'\r\ncodesystem &quot;SNOMEDCT&quot;: 'http://snomed.info/sct'\r\ncodesystem &quot;ICD10CM&quot;: 'http://hl7.org/fhir/sid/icd-10-cm'\r\n\r\nvalueset &quot;Emergency Department Visit&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292'\r\nvalueset &quot;Encounter Inpatient&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307'\r\nvalueset &quot;Hospice Status&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.101'\r\nvalueset &quot;Hospice Care Referral or Admission&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.365'\r\nvalueset &quot;Dietitian Referral&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.91'\r\nvalueset &quot;Malnutrition Diagnosis&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.55'\r\nvalueset &quot;Malnutrition Risk Screening&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.92'\r\nvalueset &quot;Malnutrition Screening Finding of At Risk Result&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.89'\r\nvalueset &quot;Malnutrition Screening Finding of Not At Risk Result&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.34'\r\nvalueset &quot;Nutrition Assessment&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.21'\r\nvalueset &quot;Nutrition Assessment Status Finding of Moderately Malnourished&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.47'\r\nvalueset &quot;Nutrition Assessment Status Finding of Well Nourished or Not Malnourished or Mildly Malnourished&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.96'\r\nvalueset &quot;Nutrition Assessment Status Finding of Severely Malnourished&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.43'\r\nvalueset &quot;Nutrition Care Plan&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1095.93'\r\nvalueset &quot;Observation Services&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143'\r\n\r\ncode &quot;Birth date&quot;: '21112-8' from &quot;LOINC&quot; display 'Birth date'\r\n\r\nparameter &quot;Measurement Period&quot; Interval&lt;DateTime&gt;\r\n\r\ncontext Patient\r\n\r\ndefine &quot;SDE Ethnicity&quot;:\r\n  SDE.&quot;SDE Ethnicity&quot;\r\n\r\ndefine &quot;SDE Payer Type&quot;:\r\n  SDE.&quot;SDE Payer&quot;\r\n\r\ndefine &quot;SDE Race&quot;:\r\n  SDE.&quot;SDE Race&quot;\r\n\r\ndefine &quot;SDE Sex&quot;:\r\n  SDE.&quot;SDE Sex&quot;\r\n\r\ndefine &quot;Measure Population&quot;:\r\n  &quot;Initial Population&quot;\r\n\r\ndefine &quot;Initial Population&quot;:\r\n  [Encounter: &quot;Encounter Inpatient&quot;] EncounterInpatient\r\n    where EncounterInpatient.period ends during day of &quot;Measurement Period&quot;\r\n      and AgeInYearsAt(date from start of EncounterInpatient.period) &gt;= 18\r\n      and ( duration in hours of EncounterInpatient.period &gt;= 24 )\r\n      and EncounterInpatient.status = 'finished'\r\n\r\ndefine &quot;Measure Population Exclusion&quot;:\r\n  &quot;Encounter with Discharge for Hospice Care&quot;\r\n    union &quot;Encounter with Hospice during Eligible Encounter&quot;\r\n\r\ndefine &quot;Encounter with Discharge for Hospice Care&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where QualifyingEncounter.hospitalization.dischargeDisposition in &quot;Hospice Care Referral or Admission&quot;\r\n\r\ndefine &quot;Intervention Hospice Care&quot;:\r\n  ( [&quot;ServiceRequest&quot;: code in &quot;Hospice Status&quot;] HospiceStatusOrder\r\n      where HospiceStatusOrder.status in { 'active', 'completed', 'on-hold' }\r\n        and HospiceStatusOrder.intent in { 'order', 'original-order', 'reflex-order', 'filler-order', 'instance-order' }\r\n        and HospiceStatusOrder.doNotPerform is not true\r\n  )\r\n    union ( [&quot;Procedure&quot;: &quot;Hospice Status&quot;] HospiceStatusPerformed\r\n        where HospiceStatusPerformed.status in { 'completed', 'in-progress' }\r\n    )\r\n\r\ndefine &quot;Encounter with Hospice during Eligible Encounter&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with &quot;Intervention Hospice Care&quot; HospiceStatus\r\n      such that Coalesce(start of HospiceStatus.performed.toInterval(), HospiceStatus.authoredOn) during day of QualifyingEncounter.hospitalizationWithObservation ( )\r\n\r\ndefine &quot;Intervention Dietitian Referral&quot;:\r\n  ( [&quot;ServiceRequest&quot;: code in &quot;Dietitian Referral&quot;] DietitianReferralOrder\r\n      where DietitianReferralOrder.status in { 'active', 'completed', 'on-hold' }\r\n        and DietitianReferralOrder.intent in { 'order', 'original-order', 'reflex-order', 'filler-order', 'instance-order' }\r\n        and DietitianReferralOrder.doNotPerform is not true\r\n  )\r\n    union ( [&quot;Procedure&quot;: &quot;Dietitian Referral&quot;] DietitianReferralPerformed\r\n        where DietitianReferralPerformed.status in { 'completed', 'in-progress' }\r\n    )\r\n\r\ndefine &quot;Encounter with Dietitian Referral&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with &quot;Intervention Dietitian Referral&quot; DietitianReferral\r\n      such that Coalesce(start of DietitianReferral.performed.toInterval(), DietitianReferral.authoredOn) during day of QualifyingEncounter.hospitalizationWithObservation ( )\r\n\r\ndefine &quot;Encounter with Malnutrition Risk Screening&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Malnutrition Risk Screening&quot;] MalnutritionRiskScreening\r\n      such that ( MalnutritionRiskScreening.status in { 'final', 'amended', 'corrected' }\r\n          and MalnutritionRiskScreening.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n          and ( MalnutritionRiskScreening.value as Concept in &quot;Malnutrition Screening Finding of Not At Risk Result&quot;\r\n              or MalnutritionRiskScreening.value as Concept in &quot;Malnutrition Screening Finding of At Risk Result&quot;\r\n          )\r\n      )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Risk Screening or with Dietitian Referral&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where ( &quot;Encounter with Malnutrition Risk Screening&quot; contains QualifyingEncounter\r\n        or &quot;Encounter with Dietitian Referral&quot; contains QualifyingEncounter\r\n    )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Risk Screening Not At Risk&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Malnutrition Risk Screening&quot;] MalnutritionRiskScreening\r\n      such that MalnutritionRiskScreening.status in { 'final', 'amended', 'corrected' }\r\n        and MalnutritionRiskScreening.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n        and ( MalnutritionRiskScreening.value as Concept in &quot;Malnutrition Screening Finding of Not At Risk Result&quot; )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Not At Risk Screening and without Dietitian Referral&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where &quot;Encounter with Malnutrition Risk Screening Not At Risk&quot; contains QualifyingEncounter\r\n      and not exists ( &quot;Encounter with Dietitian Referral&quot; )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Risk Screening At Risk&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Malnutrition Risk Screening&quot;] MalnutritionRiskScreening\r\n      such that MalnutritionRiskScreening.status in { 'final', 'amended', 'corrected' }\r\n        and MalnutritionRiskScreening.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n        and ( MalnutritionRiskScreening.value as Concept in &quot;Malnutrition Screening Finding of At Risk Result&quot; )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Risk Screening At Risk or with Dietitian Referral&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where &quot;Encounter with Malnutrition Risk Screening At Risk&quot; contains QualifyingEncounter\r\n      or &quot;Encounter with Dietitian Referral&quot; contains QualifyingEncounter\r\n    return QualifyingEncounter\r\n\r\ndefine function &quot;Last Nutrition Assessment Day During Encounter&quot;(QualifyingEncounter Encounter):\r\n  Last(&quot;Nutrition Assessment Performed&quot; NutritionAssessmentTuple\r\n      where NutritionAssessmentTuple.HospEncId = QualifyingEncounter.id\r\n      return NutritionAssessmentTuple.NutrAssessTimingLatest\r\n      sort asc\r\n  )\r\n\r\ndefine &quot;Nutrition Assessment Performed&quot;:\r\n  from\r\n    &quot;Measure Population&quot; QualifyingEncounter,\r\n    [&quot;ObservationScreeningAssessment&quot;: &quot;Nutrition Assessment&quot;] NutritionAssessment\r\n    let NAssessLatest: NutritionAssessment.effective.latest ( )\r\n    where &quot;Nutrition Assessment&quot; contains NutritionAssessment.code as Concept\r\n      and NutritionAssessment.status in { 'final', 'amended', 'corrected' }\r\n      and NutritionAssessment.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n      and NutritionAssessment.value is not null\r\n    return Tuple {\r\n      HospEncId: QualifyingEncounter.id,\r\n      HospitalizationPeriod: QualifyingEncounter.hospitalizationWithObservation ( ),\r\n      NutrAssessCode: NutritionAssessment.code as Concept,\r\n      NutrAssessId: NutritionAssessment.id,\r\n      NutrAssessResult: NutritionAssessment.value,\r\n      NutrAssessTimingEff: NutritionAssessment.effective,\r\n      NutrAssessTimingInt: NutritionAssessment.effective.toInterval ( ),\r\n      NutrAssessTimingLatest: NAssessLatest\r\n    }\r\n    sort by NutrAssessTimingLatest asc\r\n\r\ndefine &quot;Encounter With Most Recent Nutrition Assessment And Identified Status&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Nutrition Assessment&quot;] NutritionAssessment\r\n      such that ( NutritionAssessment.status in { 'final', 'amended', 'corrected' }\r\n          and NutritionAssessment.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n          and ( NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Well Nourished or Not Malnourished or Mildly Malnourished&quot;\r\n              or ( NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Moderately Malnourished&quot; )\r\n              or ( NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Severely Malnourished&quot; )\r\n          )\r\n          and ( exists ( &quot;Encounter with Malnutrition Risk Screening At Risk&quot; )\r\n              or exists ( &quot;Encounter with Dietitian Referral&quot; )\r\n          )\r\n          and NutritionAssessment.effective.latest ( ) same day as &quot;Last Nutrition Assessment Day During Encounter&quot;(QualifyingEncounter)\r\n      )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter With Most Recent Nutrition Assessment Status of Moderately Or Severely Malnourished&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Nutrition Assessment&quot;] NutritionAssessment\r\n      such that NutritionAssessment.status in { 'final', 'amended', 'corrected' }\r\n        and NutritionAssessment.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n        and ( NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Moderately Malnourished&quot;\r\n            or NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Severely Malnourished&quot;\r\n        )\r\n        and NutritionAssessment.effective.latest ( ) same day as &quot;Last Nutrition Assessment Day During Encounter&quot;(QualifyingEncounter)\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter With Most Recent Nutrition Assessment Status of Not or Mildly Malnourished&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;ObservationScreeningAssessment&quot;: &quot;Nutrition Assessment&quot;] NutritionAssessment\r\n      such that ( NutritionAssessment.status in { 'final', 'amended', 'corrected' }\r\n          and NutritionAssessment.effective.toInterval ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n          and ( NutritionAssessment.value as Concept in &quot;Nutrition Assessment Status Finding of Well Nourished or Not Malnourished or Mildly Malnourished&quot; )\r\n          and NutritionAssessment.effective.latest ( ) same day as &quot;Last Nutrition Assessment Day During Encounter&quot;(QualifyingEncounter)\r\n      )\r\n    return QualifyingEncounter\r\n\r\ndefine &quot;Encounter with Malnutrition Diagnosis&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where exists ( &quot;Has Malnutrition Diagnosis&quot; MalnutritionDiagnosis\r\n        where MalnutritionDiagnosis.prevalenceInterval ( ) overlaps day of QualifyingEncounter.hospitalizationWithObservation ( )\r\n    )\r\n      or exists &quot;Encounter With Encounter Diagnosis Of Malnutrition Diagnosis&quot;\r\n\r\ndefine &quot;Has Malnutrition Diagnosis&quot;:\r\n  [ConditionProblemsHealthConcerns: &quot;Malnutrition Diagnosis&quot;] MalnutritionDiagnosis\r\n    where MalnutritionDiagnosis.prevalenceInterval ( ) overlaps &quot;Measurement Period&quot;\r\n\r\ndefine &quot;Encounter With Encounter Diagnosis Of Malnutrition Diagnosis&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    where QualifyingEncounter.reasonCode in &quot;Malnutrition Diagnosis&quot;\r\n      or exists ( [ConditionEncounterDiagnosis: &quot;Malnutrition Diagnosis&quot;] EncounterDiagnosis\r\n          where QualifyingEncounter.reasonReference.references ( EncounterDiagnosis )\r\n      )\r\n\r\ndefine &quot;Encounter with Nutrition Care Plan&quot;:\r\n  &quot;Measure Population&quot; QualifyingEncounter\r\n    with [&quot;Procedure&quot;: &quot;Nutrition Care Plan&quot;] NutritionCarePlan\r\n      such that NutritionCarePlan.status in { 'completed', 'in-progress' }\r\n        and NutritionCarePlan.performed.earliest ( ) during QualifyingEncounter.hospitalizationWithObservation ( )\r\n    return QualifyingEncounter\r\n\r\ndefine function &quot;Measure Observation 1&quot;(MalnutritionRiskScreening Encounter):\r\n  if &quot;Encounter with Malnutrition Risk Screening or with Dietitian Referral&quot; contains MalnutritionRiskScreening then 1 \r\n    else 0\r\n\r\ndefine function &quot;Measure Observation 2&quot;(NutritionAssessment Encounter):\r\n  if &quot;Encounter with Malnutrition Not At Risk Screening and without Dietitian Referral&quot; contains NutritionAssessment then 0 \r\n    else if &quot;Encounter with Malnutrition Risk Screening At Risk or with Dietitian Referral&quot; contains NutritionAssessment then if &quot;Encounter With Most Recent Nutrition Assessment And Identified Status&quot; contains NutritionAssessment then 1 \r\n    else 0 \r\n    else 0\r\n\r\ndefine function &quot;Measure Observation 3&quot;(MalnutritionDiagnosis Encounter):\r\n  if &quot;Encounter with Malnutrition Not At Risk Screening and without Dietitian Referral&quot; contains MalnutritionDiagnosis then 0 \r\n    else if &quot;Encounter with Malnutrition Risk Screening At Risk or with Dietitian Referral&quot; contains MalnutritionDiagnosis then if &quot;Encounter with Malnutrition Diagnosis&quot; contains MalnutritionDiagnosis then if &quot;Encounter With Most Recent Nutrition Assessment Status of Not or Mildly Malnourished&quot; contains MalnutritionDiagnosis then 0 \r\n    else if &quot;Encounter With Most Recent Nutrition Assessment Status of Moderately Or Severely Malnourished&quot; contains MalnutritionDiagnosis then 1 \r\n    else 0 \r\n    else 0 \r\n    else 0\r\n\r\ndefine function &quot;Measure Observation 4&quot;(NutritionCarePlan Encounter):\r\n  if &quot;Encounter with Malnutrition Not At Risk Screening and without Dietitian Referral&quot; contains NutritionCarePlan then 0 \r\n    else if &quot;Encounter with Malnutrition Risk Screening At Risk or with Dietitian Referral&quot; contains NutritionCarePlan then if &quot;Encounter with Nutrition Care Plan&quot; contains NutritionCarePlan then if &quot;Encounter With Most Recent Nutrition Assessment Status of Not or Mildly Malnourished&quot; contains NutritionCarePlan then 0 \r\n    else if &quot;Encounter With Most Recent Nutrition Assessment Status of Moderately Or Severely Malnourished&quot; contains NutritionCarePlan then 1 \r\n    else 0 \r\n    else 0 \r\n    else 0\r\n\r\ndefine function &quot;Total Malnutrition Care Score Eligible Occurrences&quot;(QualifyingEncounter Encounter):\r\n  if ( ( &quot;Encounter with Malnutrition Risk Screening or with Dietitian Referral&quot; contains QualifyingEncounter )\r\n      and ( &quot;Encounter with Malnutrition Risk Screening Not At Risk&quot; contains QualifyingEncounter )\r\n  )\r\n    and not ( &quot;Encounter with Dietitian Referral&quot; contains QualifyingEncounter ) then 1 \r\n    else if ( ( ( &quot;Encounter with Malnutrition Risk Screening or with Dietitian Referral&quot; contains QualifyingEncounter )\r\n        and ( &quot;Encounter with Malnutrition Risk Screening At Risk&quot; contains QualifyingEncounter )\r\n    )\r\n      or ( &quot;Encounter with Dietitian Referral&quot; contains QualifyingEncounter )\r\n  )\r\n    and ( &quot;Encounter With Most Recent Nutrition Assessment Status of Not or Mildly Malnourished&quot; contains QualifyingEncounter )\r\n    or not ( &quot;Encounter With Most Recent Nutrition Assessment And Identified Status&quot; contains QualifyingEncounter ) then 2 \r\n    else 4\r\n\r\ndefine function &quot;Measure Observation Total Malnutrition Components Score&quot;(QualifyingEncounter Encounter):\r\n  Sum({ &quot;Measure Observation 1&quot;(QualifyingEncounter), &quot;Measure Observation 2&quot;(QualifyingEncounter), &quot;Measure Observation 3&quot;(QualifyingEncounter), &quot;Measure Observation 4&quot;(QualifyingEncounter) })\r\n\r\ndefine function &quot;Measure Observation Total Malnutrition Care Score as Percentage&quot;(QualifyingEncounter Encounter):\r\n  100 * ( &quot;Measure Observation Total Malnutrition Components Score&quot;(QualifyingEncounter) / &quot;Total Malnutrition Care Score Eligible Occurrences&quot;(QualifyingEncounter) )</code></pre>\n      </td>\n    </tr>\n    \n    \n    \n  \n\n<tr>\n  <th colspan=\"2\" scope=\"row\" class=\"row-header\">Generated using version 0.4.7 of the sample-content-ig Liquid templates</th>\n</tr>\n\n    </tbody>\n  </table>\n</div>"
  },
  "contained": [ {
    "resourceType": "Parameters",
    "id": "options",
    "parameter": [ {
      "name": "translatorVersion",
      "valueString": "3.25.0"
    }, {
      "name": "option",
      "valueString": "EnableAnnotations"
    }, {
      "name": "option",
      "valueString": "EnableLocators"
    }, {
      "name": "option",
      "valueString": "DisableListDemotion"
    }, {
      "name": "option",
      "valueString": "DisableListPromotion"
    }, {
      "name": "format",
      "valueString": "XML"
    }, {
      "name": "format",
      "valueString": "JSON"
    }, {
      "name": "analyzeDataRequirements",
      "valueBoolean": false
    }, {
      "name": "collapseDataRequirements",
      "valueBoolean": false
    }, {
      "name": "compatibilityLevel",
      "valueString": "1.5"
    }, {
      "name": "enableCqlOnly",
      "valueBoolean": false
    }, {
      "name": "errorLevel",
      "valueString": "Info"
    }, {
      "name": "signatureLevel",
      "valueString": "Overloads"
    }, {
      "name": "validateUnits",
      "valueBoolean": true
    }, {
      "name": "verifyOnly",
      "valueBoolean": false
    } ]
  } ],
  "extension": [ {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://loinc.org",
      "code": "21112-8",
      "display": "Birth date"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-cqlOptions",
    "valueReference": {
      "reference": "#options"
    }
  } ],
  "url": "https://madie.cms.gov/Library/CMS986FHIRMalnutritionScore",
  "identifier": [ {
    "use": "official",
    "system": "https://madie.cms.gov/login",
    "value": "CMS986FHIRMalnutritionScore"
  } ],
  "version": "0.3.003",
  "name": "CMS986FHIRMalnutritionScore",
  "title": "CMS986FHIRMalnutritionScore",
  "status": "active",
  "experimental": false,
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "date": "2025-06-12T17:21:37+00:00",
  "publisher": "Academy of Nutrition and Dietetics",
  "description": "CMS986FHIRMalnutritionScore",
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBDTVM5ODZGSElSTWFsbnV0cml0aW9uU2NvcmUgdmVyc2lvbiAnMC4zLjAwMycNCg0KdXNpbmcgUUlDb3JlIHZlcnNpb24gJzYuMC4wJw0KDQppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuNC4wMDAnIGNhbGxlZCBGSElSSGVscGVycw0KaW5jbHVkZSBTdXBwbGVtZW50YWxEYXRhRWxlbWVudHMgdmVyc2lvbiAnNS4xLjAwMCcgY2FsbGVkIFNERQ0KaW5jbHVkZSBRSUNvcmVDb21tb24gdmVyc2lvbiAnNC4wLjAwMCcgY2FsbGVkIFFJQ29yZUNvbW1vbg0KaW5jbHVkZSBDUU1Db21tb24gdmVyc2lvbiAnNC4xLjAwMCcgY2FsbGVkIENRTUNvbW1vbg0KDQpjb2Rlc3lzdGVtICJMT0lOQyI6ICdodHRwOi8vbG9pbmMub3JnJw0KY29kZXN5c3RlbSAiU05PTUVEQ1QiOiAnaHR0cDovL3Nub21lZC5pbmZvL3NjdCcNCmNvZGVzeXN0ZW0gIklDRDEwQ00iOiAnaHR0cDovL2hsNy5vcmcvZmhpci9zaWQvaWNkLTEwLWNtJw0KDQp2YWx1ZXNldCAiRW1lcmdlbmN5IERlcGFydG1lbnQgVmlzaXQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMTE3LjEuNy4xLjI5MicNCnZhbHVlc2V0ICJFbmNvdW50ZXIgSW5wYXRpZW50IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzg4My4zLjY2Ni41LjMwNycNCnZhbHVlc2V0ICJIb3NwaWNlIFN0YXR1cyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjEwOTUuMTAxJw0KdmFsdWVzZXQgIkhvc3BpY2UgQ2FyZSBSZWZlcnJhbCBvciBBZG1pc3Npb24iOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTE2LjM2NScNCnZhbHVlc2V0ICJEaWV0aXRpYW4gUmVmZXJyYWwiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDk1LjkxJw0KdmFsdWVzZXQgIk1hbG51dHJpdGlvbiBEaWFnbm9zaXMiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDk1LjU1Jw0KdmFsdWVzZXQgIk1hbG51dHJpdGlvbiBSaXNrIFNjcmVlbmluZyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjEwOTUuOTInDQp2YWx1ZXNldCAiTWFsbnV0cml0aW9uIFNjcmVlbmluZyBGaW5kaW5nIG9mIEF0IFJpc2sgUmVzdWx0IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTA5NS44OScNCnZhbHVlc2V0ICJNYWxudXRyaXRpb24gU2NyZWVuaW5nIEZpbmRpbmcgb2YgTm90IEF0IFJpc2sgUmVzdWx0IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTA5NS4zNCcNCnZhbHVlc2V0ICJOdXRyaXRpb24gQXNzZXNzbWVudCI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjEwOTUuMjEnDQp2YWx1ZXNldCAiTnV0cml0aW9uIEFzc2Vzc21lbnQgU3RhdHVzIEZpbmRpbmcgb2YgTW9kZXJhdGVseSBNYWxub3VyaXNoZWQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDk1LjQ3Jw0KdmFsdWVzZXQgIk51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBGaW5kaW5nIG9mIFdlbGwgTm91cmlzaGVkIG9yIE5vdCBNYWxub3VyaXNoZWQgb3IgTWlsZGx5IE1hbG5vdXJpc2hlZCI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjEwOTUuOTYnDQp2YWx1ZXNldCAiTnV0cml0aW9uIEFzc2Vzc21lbnQgU3RhdHVzIEZpbmRpbmcgb2YgU2V2ZXJlbHkgTWFsbm91cmlzaGVkIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTA5NS40MycNCnZhbHVlc2V0ICJOdXRyaXRpb24gQ2FyZSBQbGFuIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTA5NS45MycNCnZhbHVlc2V0ICJPYnNlcnZhdGlvbiBTZXJ2aWNlcyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjExMTEuMTQzJw0KDQpjb2RlICJCaXJ0aCBkYXRlIjogJzIxMTEyLTgnIGZyb20gIkxPSU5DIiBkaXNwbGF5ICdCaXJ0aCBkYXRlJw0KDQpwYXJhbWV0ZXIgIk1lYXN1cmVtZW50IFBlcmlvZCIgSW50ZXJ2YWw8RGF0ZVRpbWU+DQoNCmNvbnRleHQgUGF0aWVudA0KDQpkZWZpbmUgIlNERSBFdGhuaWNpdHkiOg0KICBTREUuIlNERSBFdGhuaWNpdHkiDQoNCmRlZmluZSAiU0RFIFBheWVyIFR5cGUiOg0KICBTREUuIlNERSBQYXllciINCg0KZGVmaW5lICJTREUgUmFjZSI6DQogIFNERS4iU0RFIFJhY2UiDQoNCmRlZmluZSAiU0RFIFNleCI6DQogIFNERS4iU0RFIFNleCINCg0KZGVmaW5lICJNZWFzdXJlIFBvcHVsYXRpb24iOg0KICAiSW5pdGlhbCBQb3B1bGF0aW9uIg0KDQpkZWZpbmUgIkluaXRpYWwgUG9wdWxhdGlvbiI6DQogIFtFbmNvdW50ZXI6ICJFbmNvdW50ZXIgSW5wYXRpZW50Il0gRW5jb3VudGVySW5wYXRpZW50DQogICAgd2hlcmUgRW5jb3VudGVySW5wYXRpZW50LnBlcmlvZCBlbmRzIGR1cmluZyBkYXkgb2YgIk1lYXN1cmVtZW50IFBlcmlvZCINCiAgICAgIGFuZCBBZ2VJblllYXJzQXQoZGF0ZSBmcm9tIHN0YXJ0IG9mIEVuY291bnRlcklucGF0aWVudC5wZXJpb2QpID49IDE4DQogICAgICBhbmQgKCBkdXJhdGlvbiBpbiBob3VycyBvZiBFbmNvdW50ZXJJbnBhdGllbnQucGVyaW9kID49IDI0ICkNCiAgICAgIGFuZCBFbmNvdW50ZXJJbnBhdGllbnQuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KDQpkZWZpbmUgIk1lYXN1cmUgUG9wdWxhdGlvbiBFeGNsdXNpb24iOg0KICAiRW5jb3VudGVyIHdpdGggRGlzY2hhcmdlIGZvciBIb3NwaWNlIENhcmUiDQogICAgdW5pb24gIkVuY291bnRlciB3aXRoIEhvc3BpY2UgZHVyaW5nIEVsaWdpYmxlIEVuY291bnRlciINCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBEaXNjaGFyZ2UgZm9yIEhvc3BpY2UgQ2FyZSI6DQogICJNZWFzdXJlIFBvcHVsYXRpb24iIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICB3aGVyZSBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbi5kaXNjaGFyZ2VEaXNwb3NpdGlvbiBpbiAiSG9zcGljZSBDYXJlIFJlZmVycmFsIG9yIEFkbWlzc2lvbiINCg0KZGVmaW5lICJJbnRlcnZlbnRpb24gSG9zcGljZSBDYXJlIjoNCiAgKCBbIlNlcnZpY2VSZXF1ZXN0IjogY29kZSBpbiAiSG9zcGljZSBTdGF0dXMiXSBIb3NwaWNlU3RhdHVzT3JkZXINCiAgICAgIHdoZXJlIEhvc3BpY2VTdGF0dXNPcmRlci5zdGF0dXMgaW4geyAnYWN0aXZlJywgJ2NvbXBsZXRlZCcsICdvbi1ob2xkJyB9DQogICAgICAgIGFuZCBIb3NwaWNlU3RhdHVzT3JkZXIuaW50ZW50IGluIHsgJ29yZGVyJywgJ29yaWdpbmFsLW9yZGVyJywgJ3JlZmxleC1vcmRlcicsICdmaWxsZXItb3JkZXInLCAnaW5zdGFuY2Utb3JkZXInIH0NCiAgICAgICAgYW5kIEhvc3BpY2VTdGF0dXNPcmRlci5kb05vdFBlcmZvcm0gaXMgbm90IHRydWUNCiAgKQ0KICAgIHVuaW9uICggWyJQcm9jZWR1cmUiOiAiSG9zcGljZSBTdGF0dXMiXSBIb3NwaWNlU3RhdHVzUGVyZm9ybWVkDQogICAgICAgIHdoZXJlIEhvc3BpY2VTdGF0dXNQZXJmb3JtZWQuc3RhdHVzIGluIHsgJ2NvbXBsZXRlZCcsICdpbi1wcm9ncmVzcycgfQ0KICAgICkNCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBIb3NwaWNlIGR1cmluZyBFbGlnaWJsZSBFbmNvdW50ZXIiOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCAiSW50ZXJ2ZW50aW9uIEhvc3BpY2UgQ2FyZSIgSG9zcGljZVN0YXR1cw0KICAgICAgc3VjaCB0aGF0IENvYWxlc2NlKHN0YXJ0IG9mIEhvc3BpY2VTdGF0dXMucGVyZm9ybWVkLnRvSW50ZXJ2YWwoKSwgSG9zcGljZVN0YXR1cy5hdXRob3JlZE9uKSBkdXJpbmcgZGF5IG9mIFF1YWxpZnlpbmdFbmNvdW50ZXIuaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uICggKQ0KDQpkZWZpbmUgIkludGVydmVudGlvbiBEaWV0aXRpYW4gUmVmZXJyYWwiOg0KICAoIFsiU2VydmljZVJlcXVlc3QiOiBjb2RlIGluICJEaWV0aXRpYW4gUmVmZXJyYWwiXSBEaWV0aXRpYW5SZWZlcnJhbE9yZGVyDQogICAgICB3aGVyZSBEaWV0aXRpYW5SZWZlcnJhbE9yZGVyLnN0YXR1cyBpbiB7ICdhY3RpdmUnLCAnY29tcGxldGVkJywgJ29uLWhvbGQnIH0NCiAgICAgICAgYW5kIERpZXRpdGlhblJlZmVycmFsT3JkZXIuaW50ZW50IGluIHsgJ29yZGVyJywgJ29yaWdpbmFsLW9yZGVyJywgJ3JlZmxleC1vcmRlcicsICdmaWxsZXItb3JkZXInLCAnaW5zdGFuY2Utb3JkZXInIH0NCiAgICAgICAgYW5kIERpZXRpdGlhblJlZmVycmFsT3JkZXIuZG9Ob3RQZXJmb3JtIGlzIG5vdCB0cnVlDQogICkNCiAgICB1bmlvbiAoIFsiUHJvY2VkdXJlIjogIkRpZXRpdGlhbiBSZWZlcnJhbCJdIERpZXRpdGlhblJlZmVycmFsUGVyZm9ybWVkDQogICAgICAgIHdoZXJlIERpZXRpdGlhblJlZmVycmFsUGVyZm9ybWVkLnN0YXR1cyBpbiB7ICdjb21wbGV0ZWQnLCAnaW4tcHJvZ3Jlc3MnIH0NCiAgICApDQoNCmRlZmluZSAiRW5jb3VudGVyIHdpdGggRGlldGl0aWFuIFJlZmVycmFsIjoNCiAgIk1lYXN1cmUgUG9wdWxhdGlvbiIgUXVhbGlmeWluZ0VuY291bnRlcg0KICAgIHdpdGggIkludGVydmVudGlvbiBEaWV0aXRpYW4gUmVmZXJyYWwiIERpZXRpdGlhblJlZmVycmFsDQogICAgICBzdWNoIHRoYXQgQ29hbGVzY2Uoc3RhcnQgb2YgRGlldGl0aWFuUmVmZXJyYWwucGVyZm9ybWVkLnRvSW50ZXJ2YWwoKSwgRGlldGl0aWFuUmVmZXJyYWwuYXV0aG9yZWRPbikgZHVyaW5nIGRheSBvZiBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmciOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmciXSBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nDQogICAgICBzdWNoIHRoYXQgKCBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nLnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCcgfQ0KICAgICAgICAgIGFuZCBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nLmVmZmVjdGl2ZS50b0ludGVydmFsICggKSBkdXJpbmcgUXVhbGlmeWluZ0VuY291bnRlci5ob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24gKCApDQogICAgICAgICAgYW5kICggTWFsbnV0cml0aW9uUmlza1NjcmVlbmluZy52YWx1ZSBhcyBDb25jZXB0IGluICJNYWxudXRyaXRpb24gU2NyZWVuaW5nIEZpbmRpbmcgb2YgTm90IEF0IFJpc2sgUmVzdWx0Ig0KICAgICAgICAgICAgICBvciBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nLnZhbHVlIGFzIENvbmNlcHQgaW4gIk1hbG51dHJpdGlvbiBTY3JlZW5pbmcgRmluZGluZyBvZiBBdCBSaXNrIFJlc3VsdCINCiAgICAgICAgICApDQogICAgICApDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgb3Igd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2hlcmUgKCAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIiBjb250YWlucyBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgICAgIG9yICJFbmNvdW50ZXIgd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICApDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgTm90IEF0IFJpc2siOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmciXSBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nDQogICAgICBzdWNoIHRoYXQgTWFsbnV0cml0aW9uUmlza1NjcmVlbmluZy5zdGF0dXMgaW4geyAnZmluYWwnLCAnYW1lbmRlZCcsICdjb3JyZWN0ZWQnIH0NCiAgICAgICAgYW5kIE1hbG51dHJpdGlvblJpc2tTY3JlZW5pbmcuZWZmZWN0aXZlLnRvSW50ZXJ2YWwgKCApIGR1cmluZyBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICAgICAgYW5kICggTWFsbnV0cml0aW9uUmlza1NjcmVlbmluZy52YWx1ZSBhcyBDb25jZXB0IGluICJNYWxudXRyaXRpb24gU2NyZWVuaW5nIEZpbmRpbmcgb2YgTm90IEF0IFJpc2sgUmVzdWx0IiApDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gTm90IEF0IFJpc2sgU2NyZWVuaW5nIGFuZCB3aXRob3V0IERpZXRpdGlhbiBSZWZlcnJhbCI6DQogICJNZWFzdXJlIFBvcHVsYXRpb24iIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICB3aGVyZSAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIE5vdCBBdCBSaXNrIiBjb250YWlucyBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgICBhbmQgbm90IGV4aXN0cyAoICJFbmNvdW50ZXIgd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiICkNCiAgICByZXR1cm4gUXVhbGlmeWluZ0VuY291bnRlcg0KDQpkZWZpbmUgIkVuY291bnRlciB3aXRoIE1hbG51dHJpdGlvbiBSaXNrIFNjcmVlbmluZyBBdCBSaXNrIjoNCiAgIk1lYXN1cmUgUG9wdWxhdGlvbiIgUXVhbGlmeWluZ0VuY291bnRlcg0KICAgIHdpdGggWyJPYnNlcnZhdGlvblNjcmVlbmluZ0Fzc2Vzc21lbnQiOiAiTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIl0gTWFsbnV0cml0aW9uUmlza1NjcmVlbmluZw0KICAgICAgc3VjaCB0aGF0IE1hbG51dHJpdGlvblJpc2tTY3JlZW5pbmcuc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJyB9DQogICAgICAgIGFuZCBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nLmVmZmVjdGl2ZS50b0ludGVydmFsICggKSBkdXJpbmcgUXVhbGlmeWluZ0VuY291bnRlci5ob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24gKCApDQogICAgICAgIGFuZCAoIE1hbG51dHJpdGlvblJpc2tTY3JlZW5pbmcudmFsdWUgYXMgQ29uY2VwdCBpbiAiTWFsbnV0cml0aW9uIFNjcmVlbmluZyBGaW5kaW5nIG9mIEF0IFJpc2sgUmVzdWx0IiApDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgQXQgUmlzayBvciB3aXRoIERpZXRpdGlhbiBSZWZlcnJhbCI6DQogICJNZWFzdXJlIFBvcHVsYXRpb24iIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICB3aGVyZSAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIEF0IFJpc2siIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICAgIG9yICJFbmNvdW50ZXIgd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICByZXR1cm4gUXVhbGlmeWluZ0VuY291bnRlcg0KDQpkZWZpbmUgZnVuY3Rpb24gIkxhc3QgTnV0cml0aW9uIEFzc2Vzc21lbnQgRGF5IER1cmluZyBFbmNvdW50ZXIiKFF1YWxpZnlpbmdFbmNvdW50ZXIgRW5jb3VudGVyKToNCiAgTGFzdCgiTnV0cml0aW9uIEFzc2Vzc21lbnQgUGVyZm9ybWVkIiBOdXRyaXRpb25Bc3Nlc3NtZW50VHVwbGUNCiAgICAgIHdoZXJlIE51dHJpdGlvbkFzc2Vzc21lbnRUdXBsZS5Ib3NwRW5jSWQgPSBRdWFsaWZ5aW5nRW5jb3VudGVyLmlkDQogICAgICByZXR1cm4gTnV0cml0aW9uQXNzZXNzbWVudFR1cGxlLk51dHJBc3Nlc3NUaW1pbmdMYXRlc3QNCiAgICAgIHNvcnQgYXNjDQogICkNCg0KZGVmaW5lICJOdXRyaXRpb24gQXNzZXNzbWVudCBQZXJmb3JtZWQiOg0KICBmcm9tDQogICAgIk1lYXN1cmUgUG9wdWxhdGlvbiIgUXVhbGlmeWluZ0VuY291bnRlciwNCiAgICBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJOdXRyaXRpb24gQXNzZXNzbWVudCJdIE51dHJpdGlvbkFzc2Vzc21lbnQNCiAgICBsZXQgTkFzc2Vzc0xhdGVzdDogTnV0cml0aW9uQXNzZXNzbWVudC5lZmZlY3RpdmUubGF0ZXN0ICggKQ0KICAgIHdoZXJlICJOdXRyaXRpb24gQXNzZXNzbWVudCIgY29udGFpbnMgTnV0cml0aW9uQXNzZXNzbWVudC5jb2RlIGFzIENvbmNlcHQNCiAgICAgIGFuZCBOdXRyaXRpb25Bc3Nlc3NtZW50LnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCcgfQ0KICAgICAgYW5kIE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLnRvSW50ZXJ2YWwgKCApIGR1cmluZyBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICAgIGFuZCBOdXRyaXRpb25Bc3Nlc3NtZW50LnZhbHVlIGlzIG5vdCBudWxsDQogICAgcmV0dXJuIFR1cGxlIHsNCiAgICAgIEhvc3BFbmNJZDogUXVhbGlmeWluZ0VuY291bnRlci5pZCwNCiAgICAgIEhvc3BpdGFsaXphdGlvblBlcmlvZDogUXVhbGlmeWluZ0VuY291bnRlci5ob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24gKCApLA0KICAgICAgTnV0ckFzc2Vzc0NvZGU6IE51dHJpdGlvbkFzc2Vzc21lbnQuY29kZSBhcyBDb25jZXB0LA0KICAgICAgTnV0ckFzc2Vzc0lkOiBOdXRyaXRpb25Bc3Nlc3NtZW50LmlkLA0KICAgICAgTnV0ckFzc2Vzc1Jlc3VsdDogTnV0cml0aW9uQXNzZXNzbWVudC52YWx1ZSwNCiAgICAgIE51dHJBc3Nlc3NUaW1pbmdFZmY6IE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLA0KICAgICAgTnV0ckFzc2Vzc1RpbWluZ0ludDogTnV0cml0aW9uQXNzZXNzbWVudC5lZmZlY3RpdmUudG9JbnRlcnZhbCAoICksDQogICAgICBOdXRyQXNzZXNzVGltaW5nTGF0ZXN0OiBOQXNzZXNzTGF0ZXN0DQogICAgfQ0KICAgIHNvcnQgYnkgTnV0ckFzc2Vzc1RpbWluZ0xhdGVzdCBhc2MNCg0KZGVmaW5lICJFbmNvdW50ZXIgV2l0aCBNb3N0IFJlY2VudCBOdXRyaXRpb24gQXNzZXNzbWVudCBBbmQgSWRlbnRpZmllZCBTdGF0dXMiOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJOdXRyaXRpb24gQXNzZXNzbWVudCJdIE51dHJpdGlvbkFzc2Vzc21lbnQNCiAgICAgIHN1Y2ggdGhhdCAoIE51dHJpdGlvbkFzc2Vzc21lbnQuc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJyB9DQogICAgICAgICAgYW5kIE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLnRvSW50ZXJ2YWwgKCApIGR1cmluZyBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICAgICAgICBhbmQgKCBOdXRyaXRpb25Bc3Nlc3NtZW50LnZhbHVlIGFzIENvbmNlcHQgaW4gIk51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBGaW5kaW5nIG9mIFdlbGwgTm91cmlzaGVkIG9yIE5vdCBNYWxub3VyaXNoZWQgb3IgTWlsZGx5IE1hbG5vdXJpc2hlZCINCiAgICAgICAgICAgICAgb3IgKCBOdXRyaXRpb25Bc3Nlc3NtZW50LnZhbHVlIGFzIENvbmNlcHQgaW4gIk51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBGaW5kaW5nIG9mIE1vZGVyYXRlbHkgTWFsbm91cmlzaGVkIiApDQogICAgICAgICAgICAgIG9yICggTnV0cml0aW9uQXNzZXNzbWVudC52YWx1ZSBhcyBDb25jZXB0IGluICJOdXRyaXRpb24gQXNzZXNzbWVudCBTdGF0dXMgRmluZGluZyBvZiBTZXZlcmVseSBNYWxub3VyaXNoZWQiICkNCiAgICAgICAgICApDQogICAgICAgICAgYW5kICggZXhpc3RzICggIkVuY291bnRlciB3aXRoIE1hbG51dHJpdGlvbiBSaXNrIFNjcmVlbmluZyBBdCBSaXNrIiApDQogICAgICAgICAgICAgIG9yIGV4aXN0cyAoICJFbmNvdW50ZXIgd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiICkNCiAgICAgICAgICApDQogICAgICAgICAgYW5kIE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLmxhdGVzdCAoICkgc2FtZSBkYXkgYXMgIkxhc3QgTnV0cml0aW9uIEFzc2Vzc21lbnQgRGF5IER1cmluZyBFbmNvdW50ZXIiKFF1YWxpZnlpbmdFbmNvdW50ZXIpDQogICAgICApDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgV2l0aCBNb3N0IFJlY2VudCBOdXRyaXRpb24gQXNzZXNzbWVudCBTdGF0dXMgb2YgTW9kZXJhdGVseSBPciBTZXZlcmVseSBNYWxub3VyaXNoZWQiOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJOdXRyaXRpb24gQXNzZXNzbWVudCJdIE51dHJpdGlvbkFzc2Vzc21lbnQNCiAgICAgIHN1Y2ggdGhhdCBOdXRyaXRpb25Bc3Nlc3NtZW50LnN0YXR1cyBpbiB7ICdmaW5hbCcsICdhbWVuZGVkJywgJ2NvcnJlY3RlZCcgfQ0KICAgICAgICBhbmQgTnV0cml0aW9uQXNzZXNzbWVudC5lZmZlY3RpdmUudG9JbnRlcnZhbCAoICkgZHVyaW5nIFF1YWxpZnlpbmdFbmNvdW50ZXIuaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uICggKQ0KICAgICAgICBhbmQgKCBOdXRyaXRpb25Bc3Nlc3NtZW50LnZhbHVlIGFzIENvbmNlcHQgaW4gIk51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBGaW5kaW5nIG9mIE1vZGVyYXRlbHkgTWFsbm91cmlzaGVkIg0KICAgICAgICAgICAgb3IgTnV0cml0aW9uQXNzZXNzbWVudC52YWx1ZSBhcyBDb25jZXB0IGluICJOdXRyaXRpb24gQXNzZXNzbWVudCBTdGF0dXMgRmluZGluZyBvZiBTZXZlcmVseSBNYWxub3VyaXNoZWQiDQogICAgICAgICkNCiAgICAgICAgYW5kIE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLmxhdGVzdCAoICkgc2FtZSBkYXkgYXMgIkxhc3QgTnV0cml0aW9uIEFzc2Vzc21lbnQgRGF5IER1cmluZyBFbmNvdW50ZXIiKFF1YWxpZnlpbmdFbmNvdW50ZXIpDQogICAgcmV0dXJuIFF1YWxpZnlpbmdFbmNvdW50ZXINCg0KZGVmaW5lICJFbmNvdW50ZXIgV2l0aCBNb3N0IFJlY2VudCBOdXRyaXRpb24gQXNzZXNzbWVudCBTdGF0dXMgb2YgTm90IG9yIE1pbGRseSBNYWxub3VyaXNoZWQiOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIk9ic2VydmF0aW9uU2NyZWVuaW5nQXNzZXNzbWVudCI6ICJOdXRyaXRpb24gQXNzZXNzbWVudCJdIE51dHJpdGlvbkFzc2Vzc21lbnQNCiAgICAgIHN1Y2ggdGhhdCAoIE51dHJpdGlvbkFzc2Vzc21lbnQuc3RhdHVzIGluIHsgJ2ZpbmFsJywgJ2FtZW5kZWQnLCAnY29ycmVjdGVkJyB9DQogICAgICAgICAgYW5kIE51dHJpdGlvbkFzc2Vzc21lbnQuZWZmZWN0aXZlLnRvSW50ZXJ2YWwgKCApIGR1cmluZyBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICAgICAgICBhbmQgKCBOdXRyaXRpb25Bc3Nlc3NtZW50LnZhbHVlIGFzIENvbmNlcHQgaW4gIk51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBGaW5kaW5nIG9mIFdlbGwgTm91cmlzaGVkIG9yIE5vdCBNYWxub3VyaXNoZWQgb3IgTWlsZGx5IE1hbG5vdXJpc2hlZCIgKQ0KICAgICAgICAgIGFuZCBOdXRyaXRpb25Bc3Nlc3NtZW50LmVmZmVjdGl2ZS5sYXRlc3QgKCApIHNhbWUgZGF5IGFzICJMYXN0IE51dHJpdGlvbiBBc3Nlc3NtZW50IERheSBEdXJpbmcgRW5jb3VudGVyIihRdWFsaWZ5aW5nRW5jb3VudGVyKQ0KICAgICAgKQ0KICAgIHJldHVybiBRdWFsaWZ5aW5nRW5jb3VudGVyDQoNCmRlZmluZSAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIERpYWdub3NpcyI6DQogICJNZWFzdXJlIFBvcHVsYXRpb24iIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICB3aGVyZSBleGlzdHMgKCAiSGFzIE1hbG51dHJpdGlvbiBEaWFnbm9zaXMiIE1hbG51dHJpdGlvbkRpYWdub3Npcw0KICAgICAgICB3aGVyZSBNYWxudXRyaXRpb25EaWFnbm9zaXMucHJldmFsZW5jZUludGVydmFsICggKSBvdmVybGFwcyBkYXkgb2YgUXVhbGlmeWluZ0VuY291bnRlci5ob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24gKCApDQogICAgKQ0KICAgICAgb3IgZXhpc3RzICJFbmNvdW50ZXIgV2l0aCBFbmNvdW50ZXIgRGlhZ25vc2lzIE9mIE1hbG51dHJpdGlvbiBEaWFnbm9zaXMiDQoNCmRlZmluZSAiSGFzIE1hbG51dHJpdGlvbiBEaWFnbm9zaXMiOg0KICBbQ29uZGl0aW9uUHJvYmxlbXNIZWFsdGhDb25jZXJuczogIk1hbG51dHJpdGlvbiBEaWFnbm9zaXMiXSBNYWxudXRyaXRpb25EaWFnbm9zaXMNCiAgICB3aGVyZSBNYWxudXRyaXRpb25EaWFnbm9zaXMucHJldmFsZW5jZUludGVydmFsICggKSBvdmVybGFwcyAiTWVhc3VyZW1lbnQgUGVyaW9kIg0KDQpkZWZpbmUgIkVuY291bnRlciBXaXRoIEVuY291bnRlciBEaWFnbm9zaXMgT2YgTWFsbnV0cml0aW9uIERpYWdub3NpcyI6DQogICJNZWFzdXJlIFBvcHVsYXRpb24iIFF1YWxpZnlpbmdFbmNvdW50ZXINCiAgICB3aGVyZSBRdWFsaWZ5aW5nRW5jb3VudGVyLnJlYXNvbkNvZGUgaW4gIk1hbG51dHJpdGlvbiBEaWFnbm9zaXMiDQogICAgICBvciBleGlzdHMgKCBbQ29uZGl0aW9uRW5jb3VudGVyRGlhZ25vc2lzOiAiTWFsbnV0cml0aW9uIERpYWdub3NpcyJdIEVuY291bnRlckRpYWdub3Npcw0KICAgICAgICAgIHdoZXJlIFF1YWxpZnlpbmdFbmNvdW50ZXIucmVhc29uUmVmZXJlbmNlLnJlZmVyZW5jZXMgKCBFbmNvdW50ZXJEaWFnbm9zaXMgKQ0KICAgICAgKQ0KDQpkZWZpbmUgIkVuY291bnRlciB3aXRoIE51dHJpdGlvbiBDYXJlIFBsYW4iOg0KICAiTWVhc3VyZSBQb3B1bGF0aW9uIiBRdWFsaWZ5aW5nRW5jb3VudGVyDQogICAgd2l0aCBbIlByb2NlZHVyZSI6ICJOdXRyaXRpb24gQ2FyZSBQbGFuIl0gTnV0cml0aW9uQ2FyZVBsYW4NCiAgICAgIHN1Y2ggdGhhdCBOdXRyaXRpb25DYXJlUGxhbi5zdGF0dXMgaW4geyAnY29tcGxldGVkJywgJ2luLXByb2dyZXNzJyB9DQogICAgICAgIGFuZCBOdXRyaXRpb25DYXJlUGxhbi5wZXJmb3JtZWQuZWFybGllc3QgKCApIGR1cmluZyBRdWFsaWZ5aW5nRW5jb3VudGVyLmhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbiAoICkNCiAgICByZXR1cm4gUXVhbGlmeWluZ0VuY291bnRlcg0KDQpkZWZpbmUgZnVuY3Rpb24gIk1lYXN1cmUgT2JzZXJ2YXRpb24gMSIoTWFsbnV0cml0aW9uUmlza1NjcmVlbmluZyBFbmNvdW50ZXIpOg0KICBpZiAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIG9yIHdpdGggRGlldGl0aWFuIFJlZmVycmFsIiBjb250YWlucyBNYWxudXRyaXRpb25SaXNrU2NyZWVuaW5nIHRoZW4gMSANCiAgICBlbHNlIDANCg0KZGVmaW5lIGZ1bmN0aW9uICJNZWFzdXJlIE9ic2VydmF0aW9uIDIiKE51dHJpdGlvbkFzc2Vzc21lbnQgRW5jb3VudGVyKToNCiAgaWYgIkVuY291bnRlciB3aXRoIE1hbG51dHJpdGlvbiBOb3QgQXQgUmlzayBTY3JlZW5pbmcgYW5kIHdpdGhvdXQgRGlldGl0aWFuIFJlZmVycmFsIiBjb250YWlucyBOdXRyaXRpb25Bc3Nlc3NtZW50IHRoZW4gMCANCiAgICBlbHNlIGlmICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgQXQgUmlzayBvciB3aXRoIERpZXRpdGlhbiBSZWZlcnJhbCIgY29udGFpbnMgTnV0cml0aW9uQXNzZXNzbWVudCB0aGVuIGlmICJFbmNvdW50ZXIgV2l0aCBNb3N0IFJlY2VudCBOdXRyaXRpb24gQXNzZXNzbWVudCBBbmQgSWRlbnRpZmllZCBTdGF0dXMiIGNvbnRhaW5zIE51dHJpdGlvbkFzc2Vzc21lbnQgdGhlbiAxIA0KICAgIGVsc2UgMCANCiAgICBlbHNlIDANCg0KZGVmaW5lIGZ1bmN0aW9uICJNZWFzdXJlIE9ic2VydmF0aW9uIDMiKE1hbG51dHJpdGlvbkRpYWdub3NpcyBFbmNvdW50ZXIpOg0KICBpZiAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIE5vdCBBdCBSaXNrIFNjcmVlbmluZyBhbmQgd2l0aG91dCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIE1hbG51dHJpdGlvbkRpYWdub3NpcyB0aGVuIDAgDQogICAgZWxzZSBpZiAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIEF0IFJpc2sgb3Igd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIE1hbG51dHJpdGlvbkRpYWdub3NpcyB0aGVuIGlmICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gRGlhZ25vc2lzIiBjb250YWlucyBNYWxudXRyaXRpb25EaWFnbm9zaXMgdGhlbiBpZiAiRW5jb3VudGVyIFdpdGggTW9zdCBSZWNlbnQgTnV0cml0aW9uIEFzc2Vzc21lbnQgU3RhdHVzIG9mIE5vdCBvciBNaWxkbHkgTWFsbm91cmlzaGVkIiBjb250YWlucyBNYWxudXRyaXRpb25EaWFnbm9zaXMgdGhlbiAwIA0KICAgIGVsc2UgaWYgIkVuY291bnRlciBXaXRoIE1vc3QgUmVjZW50IE51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBvZiBNb2RlcmF0ZWx5IE9yIFNldmVyZWx5IE1hbG5vdXJpc2hlZCIgY29udGFpbnMgTWFsbnV0cml0aW9uRGlhZ25vc2lzIHRoZW4gMSANCiAgICBlbHNlIDAgDQogICAgZWxzZSAwIA0KICAgIGVsc2UgMA0KDQpkZWZpbmUgZnVuY3Rpb24gIk1lYXN1cmUgT2JzZXJ2YXRpb24gNCIoTnV0cml0aW9uQ2FyZVBsYW4gRW5jb3VudGVyKToNCiAgaWYgIkVuY291bnRlciB3aXRoIE1hbG51dHJpdGlvbiBOb3QgQXQgUmlzayBTY3JlZW5pbmcgYW5kIHdpdGhvdXQgRGlldGl0aWFuIFJlZmVycmFsIiBjb250YWlucyBOdXRyaXRpb25DYXJlUGxhbiB0aGVuIDAgDQogICAgZWxzZSBpZiAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIEF0IFJpc2sgb3Igd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIE51dHJpdGlvbkNhcmVQbGFuIHRoZW4gaWYgIkVuY291bnRlciB3aXRoIE51dHJpdGlvbiBDYXJlIFBsYW4iIGNvbnRhaW5zIE51dHJpdGlvbkNhcmVQbGFuIHRoZW4gaWYgIkVuY291bnRlciBXaXRoIE1vc3QgUmVjZW50IE51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBvZiBOb3Qgb3IgTWlsZGx5IE1hbG5vdXJpc2hlZCIgY29udGFpbnMgTnV0cml0aW9uQ2FyZVBsYW4gdGhlbiAwIA0KICAgIGVsc2UgaWYgIkVuY291bnRlciBXaXRoIE1vc3QgUmVjZW50IE51dHJpdGlvbiBBc3Nlc3NtZW50IFN0YXR1cyBvZiBNb2RlcmF0ZWx5IE9yIFNldmVyZWx5IE1hbG5vdXJpc2hlZCIgY29udGFpbnMgTnV0cml0aW9uQ2FyZVBsYW4gdGhlbiAxIA0KICAgIGVsc2UgMCANCiAgICBlbHNlIDAgDQogICAgZWxzZSAwDQoNCmRlZmluZSBmdW5jdGlvbiAiVG90YWwgTWFsbnV0cml0aW9uIENhcmUgU2NvcmUgRWxpZ2libGUgT2NjdXJyZW5jZXMiKFF1YWxpZnlpbmdFbmNvdW50ZXIgRW5jb3VudGVyKToNCiAgaWYgKCAoICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgb3Igd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXIgKQ0KICAgICAgYW5kICggIkVuY291bnRlciB3aXRoIE1hbG51dHJpdGlvbiBSaXNrIFNjcmVlbmluZyBOb3QgQXQgUmlzayIgY29udGFpbnMgUXVhbGlmeWluZ0VuY291bnRlciApDQogICkNCiAgICBhbmQgbm90ICggIkVuY291bnRlciB3aXRoIERpZXRpdGlhbiBSZWZlcnJhbCIgY29udGFpbnMgUXVhbGlmeWluZ0VuY291bnRlciApIHRoZW4gMSANCiAgICBlbHNlIGlmICggKCAoICJFbmNvdW50ZXIgd2l0aCBNYWxudXRyaXRpb24gUmlzayBTY3JlZW5pbmcgb3Igd2l0aCBEaWV0aXRpYW4gUmVmZXJyYWwiIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXIgKQ0KICAgICAgICBhbmQgKCAiRW5jb3VudGVyIHdpdGggTWFsbnV0cml0aW9uIFJpc2sgU2NyZWVuaW5nIEF0IFJpc2siIGNvbnRhaW5zIFF1YWxpZnlpbmdFbmNvdW50ZXIgKQ0KICAgICkNCiAgICAgIG9yICggIkVuY291bnRlciB3aXRoIERpZXRpdGlhbiBSZWZlcnJhbCIgY29udGFpbnMgUXVhbGlmeWluZ0VuY291bnRlciApDQogICkNCiAgICBhbmQgKCAiRW5jb3VudGVyIFdpdGggTW9zdCBSZWNlbnQgTnV0cml0aW9uIEFzc2Vzc21lbnQgU3RhdHVzIG9mIE5vdCBvciBNaWxkbHkgTWFsbm91cmlzaGVkIiBjb250YWlucyBRdWFsaWZ5aW5nRW5jb3VudGVyICkNCiAgICBvciBub3QgKCAiRW5jb3VudGVyIFdpdGggTW9zdCBSZWNlbnQgTnV0cml0aW9uIEFzc2Vzc21lbnQgQW5kIElkZW50aWZpZWQgU3RhdHVzIiBjb250YWlucyBRdWFsaWZ5aW5nRW5jb3VudGVyICkgdGhlbiAyIA0KICAgIGVsc2UgNA0KDQpkZWZpbmUgZnVuY3Rpb24gIk1lYXN1cmUgT2JzZXJ2YXRpb24gVG90YWwgTWFsbnV0cml0aW9uIENvbXBvbmVudHMgU2NvcmUiKFF1YWxpZnlpbmdFbmNvdW50ZXIgRW5jb3VudGVyKToNCiAgU3VtKHsgIk1lYXN1cmUgT2JzZXJ2YXRpb24gMSIoUXVhbGlmeWluZ0VuY291bnRlciksICJNZWFzdXJlIE9ic2VydmF0aW9uIDIiKFF1YWxpZnlpbmdFbmNvdW50ZXIpLCAiTWVhc3VyZSBPYnNlcnZhdGlvbiAzIihRdWFsaWZ5aW5nRW5jb3VudGVyKSwgIk1lYXN1cmUgT2JzZXJ2YXRpb24gNCIoUXVhbGlmeWluZ0VuY291bnRlcikgfSkNCg0KZGVmaW5lIGZ1bmN0aW9uICJNZWFzdXJlIE9ic2VydmF0aW9uIFRvdGFsIE1hbG51dHJpdGlvbiBDYXJlIFNjb3JlIGFzIFBlcmNlbnRhZ2UiKFF1YWxpZnlpbmdFbmNvdW50ZXIgRW5jb3VudGVyKToNCiAgMTAwICogKCAiTWVhc3VyZSBPYnNlcnZhdGlvbiBUb3RhbCBNYWxudXRyaXRpb24gQ29tcG9uZW50cyBTY29yZSIoUXVhbGlmeWluZ0VuY291bnRlcikgLyAiVG90YWwgTWFsbnV0cml0aW9uIENhcmUgU2NvcmUgRWxpZ2libGUgT2NjdXJyZW5jZXMiKFF1YWxpZnlpbmdFbmNvdW50ZXIpICk="
  } ]
}